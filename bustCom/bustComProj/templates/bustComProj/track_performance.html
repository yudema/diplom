{% extends 'bustComProj/base.html' %}

{% block title %}üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —É—Å–ø–µ–≤–∞–µ–º–æ—Å—Ç–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤{% endblock %}

{% block content %}
<h1>üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —É—Å–ø–µ–≤–∞–µ–º–æ—Å—Ç–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤</h1>

<p>–°—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª: <strong>{{ avg_score }}</strong></p>
<p>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –±–∞–ª–ª: <strong>{{ max_score }}</strong></p>
<p>–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –±–∞–ª–ª: <strong>{{ min_score }}</strong></p>

<h2>üìä –ì–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞ –æ—Ü–µ–Ω–æ–∫</h2>
<canvas id="scoreChart"></canvas>

<h2>üéØ –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ—Ü–µ–Ω–æ–∫</h2>
<canvas id="distributionChart"></canvas>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    var ctx1 = document.getElementById('scoreChart').getContext('2d');
    new Chart(ctx1, {
        type: 'bar',
        data: {
            labels: ["–°—Ä–µ–¥–Ω–∏–π", "–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π", "–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π"],
            datasets: [{
                label: "–ë–∞–ª—ã",
                data: [{{ avg_score }}, {{ max_score }}, {{ min_score }}],
                backgroundColor: ['#00ffcc', '#ff00ff', '#ff6600']
            }]
        },
        options: { responsive: true, scales: { y: { beginAtZero: true } } }
    });

    var ctx2 = document.getElementById('distributionChart').getContext('2d');
    new Chart(ctx2, {
        type: 'pie',
        data: {
            labels: [{% for score in scores %}"{{ score }}"{% if not forloop.last %}, {% endif %}{% endfor %}],
            datasets: [{
                data: [{% for count in counts %}{{ count }}{% if not forloop.last %}, {% endif %}{% endfor %}],
                backgroundColor: ['#ff0000', '#ff8000', '#ffff00', '#80ff00', '#00ff00', '#00ff80', '#00ffff']
            }]
        },
        options: { responsive: true }
    });
</script>
{% endblock %}
